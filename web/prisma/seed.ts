import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// テスト用: パスワードはプレーン文字列で保存する（本番ではハッシュ必須）
const USERS = [
  { id: 'usr_1', username: 'alice', email: 'alice@email.com', password: 'alice_pass', points: 10 },
  { id: 'usr_2', username: 'bob', email: 'bob@email.com', password: 'bob_pass', points: 5 },
  { id: 'usr_3', username: 'carol', email: 'carol@email.com', password: 'carol_pass', points: 0 },
  { id: 'usr_4', username: 'dave', email: 'dave@email.com', password: 'dave_pass', points: 2 },
  { id: 'usr_5', username: 'eve', email: 'eve@email.com', password: 'eve_pass', points: 7 },
  { id: 'usr_6', username: 'frank', email: 'frank@email.com', password: 'frank_pass', points: 1 },
  { id: 'usr_7', username: 'grace', email: 'grace@email.com', password: 'grace_pass', points: 3 },
  { id: 'usr_8', username: 'heidi', email: 'heidi@email.com', password: 'heidi_pass', points: 4 },
  { id: 'usr_9', username: 'ivan', email: 'ivan@email.com', password: 'ivan_pass', points: 6 },
  { id: 'usr_10', username: 'judy', email: 'judy@email.com', password: 'judy_pass', points: 8 },
];

const EVENTS = [
  {
    id: "evt_1",
    title: "朝ラン (東京駅)",
    description: "東京駅周辺での朝ランニング",
    imageUrl: "/images/test1.png",
    latitude: 35.681236,
    longitude: 139.767125,
    eventstartDay: new Date("2025-11-16"),
    eventfinishDay: new Date("2025-11-16"),
    authorId: "usr_1",
  },
  {
    id: "evt_2",
    title: "英語カフェ (新宿)",
    description: "新宿で英語で雑談するカジュアルな集まり",
    imageUrl: null,
    latitude: 35.690921,
    longitude: 139.700258,
    eventstartDay: new Date("2025-11-17"),
    eventfinishDay: new Date("2025-11-17"),
    authorId: "usr_2",
  },
  {
    id: "evt_3",
    title: "プログラミング勉強会 (渋谷)",
    description: "渋谷で初心者向けのハンズオン",
    imageUrl: null,
    latitude: 35.658034,
    longitude: 139.701636,
    eventstartDay: new Date("2025-11-18"),
    eventfinishDay: new Date("2025-11-19"),
    authorId: "usr_3",
  },
  {
    id: "evt_4",
    title: "写真散歩 (池袋)",
    description: "池袋周辺をカメラを持って散策",
    imageUrl: null,
    latitude: 35.728926,
    longitude: 139.71038,
    eventstartDay: new Date("2025-11-19"),
    eventfinishDay: new Date("2025-11-20"),
    authorId: "usr_4",
  },
  {
    id: "evt_5",
    title: "ピアノ発表会 (上野)",
    description: "上野での参加自由のミニ発表会",
    imageUrl: null,
    latitude: 35.713768,
    longitude: 139.777254,
    eventstartDay: new Date("2025-11-20"),
    eventfinishDay: new Date("2025-11-21"),
    authorId: "usr_5",
  },
  {
    id: "evt_6",
    title: "ボードゲーム大会 (浅草)",
    description: "浅草で友達とボードゲームを楽しむ会",
    imageUrl: null,
    latitude: 35.714765,
    longitude: 139.796655,
    eventstartDay: new Date("2025-11-21"),
    eventfinishDay: new Date("2025-11-22"),
    authorId: "usr_6",
  },
  {
    id: "evt_7",
    title: "ハイキング (六本木)",
    description: "六本木近辺の散策（徒歩）",
    imageUrl: null,
    latitude: 35.660509,
    longitude: 139.729099,
    eventstartDay: new Date("2025-11-22"),
    eventfinishDay: new Date("2025-11-23"),
    authorId: "usr_7",
  },
  {
    id: "evt_8",
    title: "アートワークショップ (銀座)",
    description: "銀座で絵を描くワークショップ",
    imageUrl: null,
    latitude: 35.671717,
    longitude: 139.764878,
    eventstartDay: new Date("2025-11-23"),
    eventfinishDay: new Date("2025-11-24"),
    authorId: "usr_8",
  },
  {
    id: "evt_9",
    title: "映画鑑賞会 (お台場)",
    description: "お台場でみんなで映画を観る会",
    imageUrl: null,
    latitude: 35.629,
    longitude: 139.776,
    eventstartDay: new Date("2025-11-24"),
    eventfinishDay: new Date("2025-11-25"),
    authorId: "usr_9",
  },
  {
    id: "evt_10",
    title: "陶芸ワークショップ (京都)",
    description: "京都で本格的な陶芸を体験",
    imageUrl: null,
    latitude: 35.0116,
    longitude: 135.7681,
    eventstartDay: new Date("2025-10-12"),
    eventfinishDay: new Date("2025-10-14"),
    authorId: "usr_1",
  },
  {
    id: "evt_11",
    title: "ダンスレッスン (渋谷)",
    description: "渋谷で楽しくダンスを学ぶ",
    imageUrl: null,
    latitude: 35.6595,
    longitude: 139.7005,
    eventstartDay: new Date("2025-11-18"),
    eventfinishDay: new Date("2025-11-19"),
    authorId: "usr_10",
  },
  {
    id: "evt_12",
    title: "ランニングイベント (大阪)",
    description: "大阪の公園でみんなでランニング",
    imageUrl: null,
    latitude: 34.6937,
    longitude: 135.5023,
    eventstartDay: new Date("2025-11-05"),
    eventfinishDay: new Date("2025-11-06"),
    authorId: "usr_2",
  },
  {
    id: "evt_13",
    title: "コーヒーセミナー (福岡)",
    description: "福岡で美味しいコーヒーの淹れ方を学ぶ",
    imageUrl: null,
    latitude: 33.5902,
    longitude: 130.4017,
    eventstartDay: new Date("2025-11-15"),
    eventfinishDay: new Date("2025-11-16"),
    authorId: "usr_3",
  },
  {
    id: "evt_14",
    title: "ヨガ教室 (札幌)",
    description: "札幌でリフレッシュヨガ",
    imageUrl: null,
    latitude: 43.0618,
    longitude: 141.3545,
    eventstartDay: new Date("2025-12-01"),
    eventfinishDay: new Date("2025-12-02"),
    authorId: "usr_4",
  },
  {
    id: "evt_15",
    title: "料理教室 (中野)",
    description: "中野でお手軽レシピを学ぶ",
    imageUrl: null,
    latitude: 35.707398,
    longitude: 139.66545,
    eventstartDay: new Date("2025-11-25"),
    eventfinishDay: new Date("2025-11-26"),
    authorId: "usr_5",
  },
  {
    id: "evt_16",
    title: "絵画ワークショップ (名古屋)",
    description: "名古屋で初心者向け絵画体験",
    imageUrl: null,
    latitude: 35.1815,
    longitude: 136.9066,
    eventstartDay: new Date("2025-10-20"),
    eventfinishDay: new Date("2025-10-22"),
    authorId: "usr_6",
  },
  {
    id: "evt_17",
    title: "音楽ライブ (横浜)",
    description: "横浜でアコースティックライブを楽しむ",
    imageUrl: null,
    latitude: 35.4437,
    longitude: 139.6380,
    eventstartDay: new Date("2025-11-10"),
    eventfinishDay: new Date("2025-11-11"),
    authorId: "usr_7",
  },
  {
    id: "evt_18",
    title: "写真教室 (鎌倉)",
    description: "鎌倉で風景写真を学ぶ",
    imageUrl: null,
    latitude: 35.3199,
    longitude: 139.5508,
    eventstartDay: new Date("2025-12-05"),
    eventfinishDay: new Date("2025-12-06"),
    authorId: "usr_8",
  },
  {
    id: "evt_19",
    title: "キャンプ体験 (長野)",
    description: "長野で初心者向けキャンプ体験",
    imageUrl: null,
    latitude: 36.6513,
    longitude: 138.1810,
    eventstartDay: new Date("2025-10-30"),
    eventfinishDay: new Date("2025-11-01"),
    authorId: "usr_9",
  },
  {
    id: "evt_20",
    title: "陶芸体験 (笠間)",
    description: "茨城県笠間で伝統的な陶芸を体験",
    imageUrl: null,
    latitude: 36.3493,
    longitude: 140.2586,
    eventstartDay: new Date("2025-11-10"),
    eventfinishDay: new Date("2025-11-11"),
    authorId: "usr_10",
  },
  {
    id: "evt_21",
    title: "海辺の朝ヨガ (千葉・館山)",
    description: "館山の海岸でリフレッシュヨガ",
    imageUrl: null,
    latitude: 34.9964,
    longitude: 139.8683,
    eventstartDay: new Date("2025-11-12"),
    eventfinishDay: new Date("2025-11-13"),
    authorId: "usr_1",
  },
  {
    id: "evt_22",
    title: "紅葉ハイキング (日光)",
    description: "日光の紅葉を眺めながら山歩き",
    imageUrl: null,
    latitude: 36.7202,
    longitude: 139.6983,
    eventstartDay: new Date("2025-11-14"),
    eventfinishDay: new Date("2025-11-15"),
    authorId: "usr_3",
  },
  {
    id: "evt_23",
    title: "ワイン試飲会 (山梨・勝沼)",
    description: "勝沼ワイナリーでの試飲と見学ツアー",
    imageUrl: null,
    latitude: 35.6619,
    longitude: 138.7726,
    eventstartDay: new Date("2025-11-16"),
    eventfinishDay: new Date("2025-11-17"),
    authorId: "usr_4",
  },
  {
    id: "evt_24",
    title: "イルミネーション撮影会 (神戸)",
    description: "神戸ルミナリエで夜景を撮影",
    imageUrl: null,
    latitude: 34.6913,
    longitude: 135.1830,
    eventstartDay: new Date("2025-12-02"),
    eventfinishDay: new Date("2025-12-03"),
    authorId: "usr_5",
  },
  {
    id: "evt_25",
    title: "陶芸＆そば打ち体験 (益子)",
    description: "栃木・益子で手作りの時間を楽しむ",
    imageUrl: null,
    latitude: 36.4658,
    longitude: 140.0894,
    eventstartDay: new Date("2025-11-20"),
    eventfinishDay: new Date("2025-11-21"),
    authorId: "usr_6",
  },
  {
    id: "evt_26",
    title: "冬キャンプ (富士山麓)",
    description: "富士山の麓で星空キャンプ",
    imageUrl: null,
    latitude: 35.3606,
    longitude: 138.7274,
    eventstartDay: new Date("2025-12-05"),
    eventfinishDay: new Date("2025-12-06"),
    authorId: "usr_7",
  },
  {
    id: "evt_27",
    title: "カメラ講座 (仙台)",
    description: "仙台で初心者向けの撮影講座",
    imageUrl: null,
    latitude: 38.2688,
    longitude: 140.8721,
    eventstartDay: new Date("2025-11-28"),
    eventfinishDay: new Date("2025-11-29"),
    authorId: "usr_8",
  },
  {
    id: "evt_28",
    title: "日本酒ナイト (新潟)",
    description: "新潟の地酒を味わう交流会",
    imageUrl: null,
    latitude: 37.9161,
    longitude: 139.0364,
    eventstartDay: new Date("2025-11-22"),
    eventfinishDay: new Date("2025-11-23"),
    authorId: "usr_9",
  },
  {
    id: "evt_29",
    title: "歴史散歩 (金沢)",
    description: "兼六園や城下町を散策するツアー",
    imageUrl: null,
    latitude: 36.5613,
    longitude: 136.6562,
    eventstartDay: new Date("2025-11-18"),
    eventfinishDay: new Date("2025-11-19"),
    authorId: "usr_10",
  },
  {
    id: "evt_30",
    title: "鉄道フォトツアー (水戸)",
    description: "水戸駅周辺で鉄道写真を撮ろう",
    imageUrl: null,
    latitude: 36.3708,
    longitude: 140.4769,
    eventstartDay: new Date("2025-11-26"),
    eventfinishDay: new Date("2025-11-27"),
    authorId: "usr_1",
  },
  {
    id: "evt_31",
    title: "和菓子作り体験 (京都)",
    description: "京都の老舗で和菓子づくりに挑戦",
    imageUrl: null,
    latitude: 35.0116,
    longitude: 135.7681,
    eventstartDay: new Date("2025-12-10"),
    eventfinishDay: new Date("2025-12-11"),
    authorId: "usr_2",
  },
  {
    id: "evt_32",
    title: "スノーボード合宿 (長野・白馬)",
    description: "白馬でスノボ仲間と滑りまくる2日間",
    imageUrl: null,
    latitude: 36.6980,
    longitude: 137.8606,
    eventstartDay: new Date("2025-12-08"),
    eventfinishDay: new Date("2025-12-09"),
    authorId: "usr_3",
  },
  {
    id: "evt_33",
    title: "写真展巡り (名古屋)",
    description: "名古屋市内のギャラリーを巡る写真好きイベント",
    imageUrl: null,
    latitude: 35.1815,
    longitude: 136.9066,
    eventstartDay: new Date("2025-11-15"),
    eventfinishDay: new Date("2025-11-16"),
    authorId: "usr_4",
  },
  {
    id: "evt_34",
    title: "お茶体験 (静岡)",
    description: "静岡で茶摘みと抹茶づくりを楽しむ",
    imageUrl: null,
    latitude: 34.9756,
    longitude: 138.3828,
    eventstartDay: new Date("2025-11-25"),
    eventfinishDay: new Date("2025-11-26"),
    authorId: "usr_5",
  },
  {
    id: "evt_35",
    title: "そば打ち会 (松本)",
    description: "信州松本で手打ちそばを体験",
    imageUrl: null,
    latitude: 36.2381,
    longitude: 137.9718,
    eventstartDay: new Date("2025-11-30"),
    eventfinishDay: new Date("2025-12-01"),
    authorId: "usr_6",
  },
  {
    id: "evt_36",
    title: "灯籠まつり (熊本)",
    description: "熊本の夜を彩る灯籠まつりを鑑賞",
    imageUrl: null,
    latitude: 32.8031,
    longitude: 130.7079,
    eventstartDay: new Date("2025-12-04"),
    eventfinishDay: new Date("2025-12-05"),
    authorId: "usr_7",
  },
  {
    id: "evt_37",
    title: "海鮮BBQ (函館)",
    description: "函館港で地元の海鮮を味わうBBQ大会",
    imageUrl: null,
    latitude: 41.7687,
    longitude: 140.7288,
    eventstartDay: new Date("2025-11-21"),
    eventfinishDay: new Date("2025-11-22"),
    authorId: "usr_8",
  },
  {
    id: "evt_38",
    title: "陶芸マルシェ (笠間)",
    description: "笠間焼の作家たちによる展示販売イベント",
    imageUrl: null,
    latitude: 36.3483,
    longitude: 140.2620,
    eventstartDay: new Date("2025-11-29"),
    eventfinishDay: new Date("2025-11-30"),
    authorId: "usr_9",
  },
  {
    id: "evt_39",
    title: "星空観察会 (那須高原)",
    description: "那須の高原で星空を観測する夜イベント",
    imageUrl: null,
    latitude: 37.1007,
    longitude: 140.0178,
    eventstartDay: new Date("2025-12-06"),
    eventfinishDay: new Date("2025-12-07"),
    authorId: "usr_10",
  },
  {
    id: "evt_40",
    title: "かみね公園ピクニック (日立)",
    description: "日立市のかみね公園でのんびりピクニック",
    imageUrl: null,
    latitude: 36.5884,
    longitude: 140.6517,
    eventstartDay: new Date("2025-11-14"),
    eventfinishDay: new Date("2025-11-14"),
    authorId: "usr_5",
  },
  {
    id: "evt_41",
    title: "日立駅サンセット撮影会",
    description: "海に面した日立駅で夕日を撮影する交流イベント",
    imageUrl: null,
    latitude: 36.5988,
    longitude: 140.6573,
    eventstartDay: new Date("2025-11-18"),
    eventfinishDay: new Date("2025-11-18"),
    authorId: "usr_6",
  },
  {
    id: "evt_42",
    title: "シビックセンター天文観察会 (日立)",
    description: "日立シビックセンターで望遠鏡を使った天体観察",
    imageUrl: null,
    latitude: 36.5981,
    longitude: 140.6519,
    eventstartDay: new Date("2025-11-22"),
    eventfinishDay: new Date("2025-11-22"),
    authorId: "usr_7",
  },
  {
    id: "evt_43",
    title: "川尻海岸クリーンアップ",
    description: "川尻海岸でのゴミ拾い＆ビーチウォーク",
    imageUrl: null,
    latitude: 36.6802,
    longitude: 140.7297,
    eventstartDay: new Date("2025-11-30"),
    eventfinishDay: new Date("2025-11-30"),
    authorId: "usr_8",
  },
  {
    id: "evt_44",
    title: "日立ライトアップナイト",
    description: "市街地のイルミネーションを巡るナイトウォークイベント",
    imageUrl: null,
    latitude: 36.5965,
    longitude: 140.6515,
    eventstartDay: new Date("2025-09-07"),
    eventfinishDay: new Date("2025-12-31"),
    authorId: "usr_9",
  },
  {
    id: "evt_45",
    title: "研究室公開デー (茨城大学工学部)",
    description: "茨城大学工学部の研究室を一般公開！学生の研究成果を紹介します",
    imageUrl: "/images/test2.png",
    latitude: 36.572298269450734,
    longitude: 140.64297075180048,
    eventstartDay: new Date("2025-11-15"),
    eventfinishDay: new Date("2025-11-15"),
    authorId: "usr_6",
  },
  {
    id: "evt_46",
    title: "工学部前コーヒースタンド交流会",
    description: "大学前のカフェスペースで学生・地域住民の交流会を開催",
    imageUrl: null,
    latitude: 36.5670,
    longitude: 140.6402,
    eventstartDay: new Date("2025-01-01"),
    eventfinishDay: new Date("2025-11-30"),
    authorId: "usr_7",
  },
  {
    id: "evt_47",
    title: "桜並木ウォーク (中成沢町)",
    description: "工学部周辺の桜並木を歩きながら写真撮影と交流を楽しむイベント",
    imageUrl: null,
    latitude: 36.5658,
    longitude: 140.6388,
    eventstartDay: new Date("2025-12-01"),
    eventfinishDay: new Date("2025-12-02"),
    authorId: "usr_8",
  },
];


// 参加関係をいくつか作る（例: user1..user5 がイベント1に参加など）
const PARTICIPATIONS = [
  { userId: 'usr_1', eventId: 'evt_1' },
  { userId: 'usr_2', eventId: 'evt_1' },
  { userId: 'usr_3', eventId: 'evt_2' },
  { userId: 'usr_4', eventId: 'evt_3' },
  { userId: 'usr_5', eventId: 'evt_4' },
  { userId: 'usr_6', eventId: 'evt_5' },
  { userId: 'usr_7', eventId: 'evt_6' },
  { userId: 'usr_8', eventId: 'evt_7' },
  { userId: 'usr_9', eventId: 'evt_8' },
  { userId: 'usr_10', eventId: 'evt_9' },
];

async function seed() {
  // users
  for (const u of USERS) {
    await prisma.user.upsert({
      where: { username: u.username },
      // 型安全のため、既存レコードへの update は空にして冪等にする
      update: {},
      create: u,
    });
  }

  // events
  for (const e of EVENTS) {
    await prisma.event.upsert({
      where: { id: e.id },
      // 型安全のため、既存レコードへの update は空にして冪等にする
      update: {},
      create: e,
    });
  }

  // participations
  for (const p of PARTICIPATIONS) {
    try {
      // Prisma クライアントの型が未生成の可能性があるため any 経由で作成
      await (prisma as any).eventParticipant.create({ data: { userId: p.userId, eventId: p.eventId } });
    } catch (e: any) {
      // 重複などは無視して先へ進める
      if (e?.code === 'P2002') continue;
      throw e;
    }
  }

  console.log('[seed] completed');
}

seed()
  .catch((e) => {
    console.error('[seed] failed', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
